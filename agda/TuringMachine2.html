<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>TuringMachine2</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="TuringMachine2.html" class="Module">TuringMachine2</a> <a id="23" class="Keyword">where</a>

<a id="30" class="Keyword">open</a> <a id="35" class="Keyword">import</a> <a id="42" href="Basic.html" class="Module">Basic</a> <a id="48" class="Keyword">renaming</a> <a id="57" class="Symbol">(</a><a id="58" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="60" class="Symbol">to</a> <a id="Builtin.Nat.Nat"></a><a id="63" href="TuringMachine2.html#63" class="Datatype">Nat</a><a id="66" class="Symbol">)</a>
<a id="68" class="Keyword">open</a> <a id="73" class="Keyword">import</a> <a id="80" href="Base2.html" class="Module">Base2</a>
<a id="86" class="Keyword">open</a> <a id="91" class="Keyword">import</a> <a id="98" href="Util.Arithmetic.html" class="Module">Util.Arithmetic</a>
<a id="114" class="Keyword">open</a> <a id="119" class="Keyword">import</a> <a id="126" href="Util.Bool.html" class="Module">Util.Bool</a>
<a id="136" class="Keyword">open</a> <a id="141" class="Keyword">import</a> <a id="148" href="Util.List.html" class="Module">Util.List</a>

<a id="159" class="Comment">{-
  set of states is Fin (n+1)
  starting state is 0
  Maybe Bool :
    nothing represents blank symbol
    just x represents tape symbol x
  might not be able to be universal with such a restricted definition,
  i.e. might need more symbols
-}</a>
<a id="405" class="Keyword">record</a> <a id="TuringMachine₂"></a><a id="412" href="TuringMachine2.html#412" class="Record">TuringMachine₂</a> <a id="427" class="Symbol">{</a><a id="428" href="TuringMachine2.html#428" class="Bound">n</a> <a id="430" class="Symbol">:</a> <a id="432" href="TuringMachine2.html#63" class="Datatype">Nat</a><a id="435" class="Symbol">}</a> <a id="437" class="Symbol">:</a> <a id="439" class="PrimitiveType">Set</a> <a id="443" class="Keyword">where</a>
  <a id="451" class="Keyword">field</a>
    <a id="TuringMachine₂.δ"></a><a id="461" href="TuringMachine2.html#461" class="Field">δ</a> <a id="463" class="Symbol">:</a> <a id="465" class="Symbol">(</a><a id="466" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="470" class="Symbol">(</a><a id="471" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="475" href="TuringMachine2.html#428" class="Bound">n</a><a id="476" class="Symbol">))</a> <a id="479" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="481" class="Symbol">(</a><a id="482" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="488" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="492" class="Symbol">)</a> <a id="494" class="Symbol">→</a> <a id="496" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="502" class="Symbol">((</a><a id="504" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="508" class="Symbol">(</a><a id="509" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="513" href="TuringMachine2.html#428" class="Bound">n</a><a id="514" class="Symbol">))</a> <a id="517" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="519" class="Symbol">(</a><a id="520" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="525" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="527" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="531" class="Symbol">))</a>


<a id="run₁-bool"></a><a id="536" href="TuringMachine2.html#536" class="Function">run₁-bool</a> <a id="546" class="Symbol">:</a> <a id="548" class="Symbol">{</a><a id="549" href="TuringMachine2.html#549" class="Bound">n</a> <a id="551" class="Symbol">:</a> <a id="553" href="TuringMachine2.html#63" class="Datatype">Nat</a><a id="556" class="Symbol">}</a> <a id="558" class="Symbol">→</a> <a id="560" href="TuringMachine2.html#412" class="Record">TuringMachine₂</a> <a id="575" class="Symbol">{</a><a id="576" href="TuringMachine2.html#549" class="Bound">n</a><a id="577" class="Symbol">}</a> <a id="579" class="Symbol">→</a> <a id="581" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="585" class="Symbol">(</a><a id="586" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="590" href="TuringMachine2.html#549" class="Bound">n</a><a id="591" class="Symbol">)</a> <a id="593" class="Symbol">→</a> <a id="595" href="TuringMachine2.html#63" class="Datatype">Nat</a> <a id="599" class="Symbol">→</a> <a id="601" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="606" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="611" class="Symbol">→</a> <a id="613" class="Symbol">(</a><a id="614" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="618" class="Symbol">(</a><a id="619" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="623" href="TuringMachine2.html#549" class="Bound">n</a><a id="624" class="Symbol">)</a> <a id="626" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="628" class="Symbol">(</a><a id="629" href="TuringMachine2.html#63" class="Datatype">Nat</a> <a id="633" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="635" class="Symbol">(</a><a id="636" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="641" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="645" class="Symbol">)))</a> <a id="649" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="651" class="Symbol">(</a><a id="652" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="657" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="661" class="Symbol">)</a>
<a id="663" href="TuringMachine2.html#536" class="Function">run₁-bool</a> <a id="673" class="Symbol">{</a><a id="674" href="TuringMachine2.html#674" class="Bound">n</a><a id="675" class="Symbol">}</a> <a id="677" href="TuringMachine2.html#677" class="Bound">tm</a> <a id="680" href="TuringMachine2.html#680" class="Bound">state</a> <a id="686" href="TuringMachine2.html#686" class="Bound">position</a> <a id="695" href="TuringMachine2.html#695" class="Bound">tape</a> <a id="700" class="Symbol">=</a> <a id="702" href="TuringMachine2.html#1267" class="Function">out</a>
  <a id="708" class="Keyword">where</a>
    <a id="718" href="TuringMachine2.html#718" class="Function">δ</a> <a id="720" class="Symbol">=</a> <a id="722" href="TuringMachine2.html#461" class="Field">TuringMachine₂.δ</a> <a id="739" href="TuringMachine2.html#677" class="Bound">tm</a>
    <a id="746" href="TuringMachine2.html#746" class="Function">δ₁</a> <a id="749" class="Symbol">=</a> <a id="751" href="TuringMachine2.html#718" class="Function">δ</a> <a id="753" class="Symbol">(</a><a id="754" href="TuringMachine2.html#680" class="Bound">state</a> <a id="760" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="762" class="Symbol">(</a><a id="763" href="Util.List.html#587" class="Function">get</a> <a id="767" href="TuringMachine2.html#695" class="Bound">tape</a> <a id="772" href="TuringMachine2.html#686" class="Bound">position</a><a id="780" class="Symbol">))</a>
    <a id="787" href="TuringMachine2.html#787" class="Function">get-results</a> <a id="799" class="Symbol">:</a> <a id="801" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="807" class="Symbol">(</a><a id="808" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="812" class="Symbol">(</a><a id="813" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="817" href="TuringMachine2.html#674" class="Bound">n</a><a id="818" class="Symbol">)</a> <a id="820" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="822" class="Symbol">(</a><a id="823" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="828" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="830" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="834" class="Symbol">))</a> <a id="837" class="Symbol">→</a> <a id="839" class="Symbol">(</a><a id="840" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="844" class="Symbol">(</a><a id="845" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="849" href="TuringMachine2.html#674" class="Bound">n</a><a id="850" class="Symbol">)</a> <a id="852" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="854" class="Symbol">(</a><a id="855" href="TuringMachine2.html#63" class="Datatype">Nat</a> <a id="859" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="861" class="Symbol">(</a><a id="862" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="867" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="871" class="Symbol">)))</a> <a id="875" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="877" class="Symbol">(</a><a id="878" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="883" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="887" class="Symbol">)</a>
    <a id="893" href="TuringMachine2.html#787" class="Function">get-results</a> <a id="905" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a> <a id="913" class="Symbol">=</a> <a id="915" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="920" href="TuringMachine2.html#695" class="Bound">tape</a>
    <a id="929" href="TuringMachine2.html#787" class="Function">get-results</a> <a id="941" class="Symbol">(</a><a id="942" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="947" class="Symbol">(</a><a id="948" href="TuringMachine2.html#948" class="Bound Operator">new_state</a> <a id="958" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="960" class="Symbol">(</a><a id="961" href="TuringMachine2.html#961" class="Bound">write</a> <a id="967" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="969" href="TuringMachine2.html#969" class="Bound">LR</a><a id="971" class="Symbol">)))</a> <a id="975" class="Symbol">=</a> <a id="977" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="982" class="Symbol">(</a><a id="983" href="TuringMachine2.html#948" class="Bound Operator">new_state</a> <a id="993" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="995" class="Symbol">(</a><a id="996" href="TuringMachine2.html#1042" class="Function Operator">new_position</a> <a id="1009" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1011" href="TuringMachine2.html#1126" class="Function Operator">new_tape</a><a id="1019" class="Symbol">))</a>
      <a id="1028" class="Keyword">where</a>
        <a id="1042" href="TuringMachine2.html#1042" class="Function Operator">new_position</a> <a id="1055" class="Symbol">=</a> <a id="1057" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1060" class="Symbol">((</a><a id="1062" href="TuringMachine2.html#686" class="Bound">position</a> <a id="1071" href="Basic.html#883" class="Primitive Operator">eq</a> <a id="1074" class="Number">0</a><a id="1075" class="Symbol">)</a> <a id="1077" href="Util.Bool.html#45" class="Function Operator">and</a> <a id="1081" class="Symbol">(</a><a id="1082" href="Data.Bool.Base.html#932" class="Function">not</a> <a id="1086" href="TuringMachine2.html#969" class="Bound">LR</a><a id="1088" class="Symbol">))</a> <a id="1091" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1096" class="Number">0</a> <a id="1098" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1103" class="Symbol">(</a><a id="1104" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1108" href="TuringMachine2.html#686" class="Bound">position</a><a id="1116" class="Symbol">)</a>
        <a id="1126" href="TuringMachine2.html#1126" class="Function Operator">new_tape</a> <a id="1135" class="Symbol">=</a>
          <a id="1147" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1150" class="Symbol">(</a><a id="1151" href="TuringMachine2.html#686" class="Bound">position</a> <a id="1160" href="Util.Arithmetic.html#736" class="Function Operator">gt</a> <a id="1163" class="Symbol">(</a><a id="1164" href="Data.List.Base.html#4864" class="Function">length</a> <a id="1171" href="TuringMachine2.html#695" class="Bound">tape</a><a id="1175" class="Symbol">))</a> <a id="1178" href="Data.Bool.Base.html#1283" class="Function Operator">then</a>
            <a id="1195" class="Symbol">(</a><a id="1196" href="TuringMachine2.html#961" class="Bound">write</a> <a id="1202" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1204" href="TuringMachine2.html#695" class="Bound">tape</a><a id="1208" class="Symbol">)</a>
          <a id="1220" href="Data.Bool.Base.html#1283" class="Function Operator">else</a>
            <a id="1237" class="Symbol">(</a><a id="1238" href="Util.List.html#746" class="Function">set</a> <a id="1242" href="TuringMachine2.html#695" class="Bound">tape</a> <a id="1247" href="TuringMachine2.html#686" class="Bound">position</a> <a id="1256" href="TuringMachine2.html#961" class="Bound">write</a><a id="1261" class="Symbol">)</a>
    <a id="1267" href="TuringMachine2.html#1267" class="Function">out</a> <a id="1271" class="Symbol">=</a> <a id="1273" href="TuringMachine2.html#787" class="Function">get-results</a> <a id="1285" href="TuringMachine2.html#746" class="Function">δ₁</a>

<a id="run-bool-helper"></a><a id="1289" href="TuringMachine2.html#1289" class="Function">run-bool-helper</a> <a id="1305" class="Symbol">:</a> <a id="1307" class="Symbol">{</a><a id="1308" href="TuringMachine2.html#1308" class="Bound">n</a> <a id="1310" class="Symbol">:</a> <a id="1312" href="TuringMachine2.html#63" class="Datatype">Nat</a><a id="1315" class="Symbol">}</a> <a id="1317" class="Symbol">→</a> <a id="1319" href="TuringMachine2.html#412" class="Record">TuringMachine₂</a> <a id="1334" class="Symbol">{</a><a id="1335" href="TuringMachine2.html#1308" class="Bound">n</a><a id="1336" class="Symbol">}</a> <a id="1338" class="Symbol">→</a> <a id="1340" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1345" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="1350" class="Symbol">→</a> <a id="1352" href="TuringMachine2.html#63" class="Datatype">Nat</a> <a id="1356" class="Symbol">→</a> <a id="1358" class="Symbol">(</a><a id="1359" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="1363" class="Symbol">(</a><a id="1364" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1368" href="TuringMachine2.html#1308" class="Bound">n</a><a id="1369" class="Symbol">)</a> <a id="1371" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1373" class="Symbol">(</a><a id="1374" href="TuringMachine2.html#63" class="Datatype">Nat</a> <a id="1378" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1380" class="Symbol">(</a><a id="1381" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1386" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="1390" class="Symbol">)))</a> <a id="1394" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="1396" class="Symbol">(</a><a id="1397" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1402" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="1406" class="Symbol">)</a>
<a id="1408" href="TuringMachine2.html#1289" class="Function">run-bool-helper</a> <a id="1424" class="Symbol">{</a><a id="1425" href="TuringMachine2.html#1425" class="Bound">n</a><a id="1426" class="Symbol">}</a> <a id="1428" href="TuringMachine2.html#1428" class="Bound">tm</a> <a id="1431" href="TuringMachine2.html#1431" class="Bound">tape</a> <a id="1436" class="Number">0</a> <a id="1438" class="Symbol">=</a> <a id="1440" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="1445" href="TuringMachine2.html#1431" class="Bound">tape</a>
<a id="1450" href="TuringMachine2.html#1289" class="Function">run-bool-helper</a> <a id="1466" class="Symbol">{</a><a id="1467" href="TuringMachine2.html#1467" class="Bound">n</a><a id="1468" class="Symbol">}</a> <a id="1470" href="TuringMachine2.html#1470" class="Bound">tm</a> <a id="1473" href="TuringMachine2.html#1473" class="Bound">tape</a> <a id="1478" class="Number">1</a> <a id="1480" class="Symbol">=</a> <a id="1482" href="TuringMachine2.html#536" class="Function">run₁-bool</a> <a id="1492" href="TuringMachine2.html#1470" class="Bound">tm</a> <a id="1495" href="Data.Fin.Base.html#1148" class="InductiveConstructor">zero</a> <a id="1500" class="Number">0</a> <a id="1502" href="TuringMachine2.html#1473" class="Bound">tape</a>
<a id="1507" href="TuringMachine2.html#1289" class="Function">run-bool-helper</a> <a id="1523" class="Symbol">{</a><a id="1524" href="TuringMachine2.html#1524" class="Bound">n</a><a id="1525" class="Symbol">}</a> <a id="1527" href="TuringMachine2.html#1527" class="Bound">tm</a> <a id="1530" href="TuringMachine2.html#1530" class="Bound">tape</a> <a id="1535" class="Symbol">(</a><a id="1536" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1540" class="Symbol">(</a><a id="1541" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1545" href="TuringMachine2.html#1545" class="Bound">m</a><a id="1546" class="Symbol">))</a> <a id="1549" class="Symbol">=</a> <a id="1551" href="TuringMachine2.html#1606" class="Function">get-next</a> <a id="1560" class="Symbol">(</a><a id="1561" href="TuringMachine2.html#1289" class="Function">run-bool-helper</a> <a id="1577" href="TuringMachine2.html#1527" class="Bound">tm</a> <a id="1580" href="TuringMachine2.html#1530" class="Bound">tape</a> <a id="1585" class="Symbol">(</a><a id="1586" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1590" href="TuringMachine2.html#1545" class="Bound">m</a><a id="1591" class="Symbol">))</a>
  <a id="1596" class="Keyword">where</a>
    <a id="1606" href="TuringMachine2.html#1606" class="Function">get-next</a> <a id="1615" class="Symbol">:</a> <a id="1617" class="Symbol">(</a><a id="1618" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="1622" class="Symbol">(</a><a id="1623" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1627" href="TuringMachine2.html#1524" class="Bound">n</a><a id="1628" class="Symbol">)</a> <a id="1630" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1632" class="Symbol">(</a><a id="1633" href="TuringMachine2.html#63" class="Datatype">Nat</a> <a id="1637" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1639" class="Symbol">(</a><a id="1640" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1645" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="1649" class="Symbol">)))</a> <a id="1653" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="1655" class="Symbol">(</a><a id="1656" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1661" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="1665" class="Symbol">)</a> <a id="1667" class="Symbol">→</a> <a id="1669" class="Symbol">(</a><a id="1670" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="1674" class="Symbol">(</a><a id="1675" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1679" href="TuringMachine2.html#1524" class="Bound">n</a><a id="1680" class="Symbol">)</a> <a id="1682" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1684" class="Symbol">(</a><a id="1685" href="TuringMachine2.html#63" class="Datatype">Nat</a> <a id="1689" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1691" class="Symbol">(</a><a id="1692" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1697" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="1701" class="Symbol">)))</a> <a id="1705" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="1707" class="Symbol">(</a><a id="1708" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1713" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="1717" class="Symbol">)</a>
    <a id="1723" href="TuringMachine2.html#1606" class="Function">get-next</a> <a id="1732" class="Symbol">(</a><a id="1733" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="1738" class="Symbol">(</a><a id="1739" href="TuringMachine2.html#1739" class="Bound">current-state</a> <a id="1753" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1755" class="Symbol">(</a><a id="1756" href="TuringMachine2.html#1756" class="Bound">current-position</a> <a id="1773" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1775" href="TuringMachine2.html#1775" class="Bound">current-tape</a><a id="1787" class="Symbol">)))</a> <a id="1791" class="Symbol">=</a> <a id="1793" href="TuringMachine2.html#536" class="Function">run₁-bool</a> <a id="1803" href="TuringMachine2.html#1527" class="Bound">tm</a> <a id="1806" href="TuringMachine2.html#1739" class="Bound">current-state</a> <a id="1820" href="TuringMachine2.html#1756" class="Bound">current-position</a> <a id="1837" href="TuringMachine2.html#1775" class="Bound">current-tape</a>
    <a id="1854" href="TuringMachine2.html#1606" class="Function">get-next</a> <a id="1863" class="Symbol">(</a><a id="1864" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="1869" href="TuringMachine2.html#1869" class="Bound">tape</a><a id="1873" class="Symbol">)</a> <a id="1875" class="Symbol">=</a> <a id="1877" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="1882" href="TuringMachine2.html#1869" class="Bound">tape</a>
    <a id="1891" class="Comment">-- output = get-next (run-bool-helper tm tape (suc m))</a>


<a id="run-bool"></a><a id="1948" href="TuringMachine2.html#1948" class="Function">run-bool</a> <a id="1957" class="Symbol">:</a> <a id="1959" class="Symbol">{</a><a id="1960" href="TuringMachine2.html#1960" class="Bound">n</a> <a id="1962" class="Symbol">:</a> <a id="1964" href="TuringMachine2.html#63" class="Datatype">Nat</a><a id="1967" class="Symbol">}</a> <a id="1969" class="Symbol">→</a> <a id="1971" href="TuringMachine2.html#412" class="Record">TuringMachine₂</a> <a id="1986" class="Symbol">{</a><a id="1987" href="TuringMachine2.html#1960" class="Bound">n</a><a id="1988" class="Symbol">}</a> <a id="1990" class="Symbol">→</a> <a id="1992" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1997" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="2002" class="Symbol">→</a> <a id="2004" href="TuringMachine2.html#63" class="Datatype">Nat</a> <a id="2008" class="Symbol">→</a> <a id="2010" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2015" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="2020" href="TuringMachine2.html#1948" class="Function">run-bool</a> <a id="2029" class="Symbol">{</a><a id="2030" href="TuringMachine2.html#2030" class="Bound">n</a><a id="2031" class="Symbol">}</a> <a id="2033" href="TuringMachine2.html#2033" class="Bound">tm</a> <a id="2036" href="TuringMachine2.html#2036" class="Bound">tape</a> <a id="2041" href="TuringMachine2.html#2041" class="Bound">k</a> <a id="2043" class="Symbol">=</a> <a id="2045" href="TuringMachine2.html#2097" class="Function">get-results</a> <a id="2057" class="Symbol">(</a><a id="2058" href="TuringMachine2.html#1289" class="Function">run-bool-helper</a> <a id="2074" href="TuringMachine2.html#2033" class="Bound">tm</a> <a id="2077" href="TuringMachine2.html#2036" class="Bound">tape</a> <a id="2082" href="TuringMachine2.html#2041" class="Bound">k</a><a id="2083" class="Symbol">)</a>
  <a id="2087" class="Keyword">where</a>
    <a id="2097" href="TuringMachine2.html#2097" class="Function">get-results</a> <a id="2109" class="Symbol">:</a> <a id="2111" class="Symbol">(</a><a id="2112" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="2116" class="Symbol">(</a><a id="2117" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2121" href="TuringMachine2.html#2030" class="Bound">n</a><a id="2122" class="Symbol">)</a> <a id="2124" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2126" class="Symbol">(</a><a id="2127" href="TuringMachine2.html#63" class="Datatype">Nat</a> <a id="2131" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2133" class="Symbol">(</a><a id="2134" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2139" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="2143" class="Symbol">)))</a> <a id="2147" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="2149" class="Symbol">(</a><a id="2150" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2155" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="2159" class="Symbol">)</a> <a id="2161" class="Symbol">→</a> <a id="2163" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2168" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="2177" href="TuringMachine2.html#2097" class="Function">get-results</a> <a id="2189" class="Symbol">(</a><a id="2190" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="2195" class="Symbol">(_</a> <a id="2198" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2200" class="Symbol">(_</a> <a id="2203" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2205" href="TuringMachine2.html#2205" class="Bound">tape</a><a id="2209" class="Symbol">)))</a> <a id="2213" class="Symbol">=</a> <a id="2215" href="TuringMachine2.html#2205" class="Bound">tape</a>
    <a id="2224" href="TuringMachine2.html#2097" class="Function">get-results</a> <a id="2236" class="Symbol">(</a><a id="2237" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="2242" href="TuringMachine2.html#2242" class="Bound">tape</a><a id="2246" class="Symbol">)</a> <a id="2248" class="Symbol">=</a> <a id="2250" href="TuringMachine2.html#2242" class="Bound">tape</a>

<a id="δ₁"></a><a id="2256" href="TuringMachine2.html#2256" class="Function">δ₁</a> <a id="2259" class="Symbol">:</a> <a id="2261" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="2265" class="Number">2</a> <a id="2267" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2269" class="Symbol">(</a><a id="2270" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="2276" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="2280" class="Symbol">)</a> <a id="2282" class="Symbol">→</a> <a id="2284" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="2290" class="Symbol">(</a><a id="2291" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="2295" class="Number">2</a> <a id="2297" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2299" class="Symbol">(</a><a id="2300" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="2305" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2307" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="2311" class="Symbol">))</a>
<a id="2314" href="TuringMachine2.html#2256" class="Function">δ₁</a> <a id="2317" class="Symbol">(</a><a id="2318" href="Data.Fin.Base.html#1148" class="InductiveConstructor">zero</a> <a id="2323" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2325" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a><a id="2332" class="Symbol">)</a> <a id="2334" class="Symbol">=</a> <a id="2336" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="2341" class="Symbol">((</a><a id="2343" href="Data.Fin.Base.html#1179" class="InductiveConstructor">suc</a> <a id="2347" href="Data.Fin.Base.html#1148" class="InductiveConstructor">zero</a><a id="2351" class="Symbol">)</a> <a id="2353" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2355" class="Symbol">(</a><a id="2356" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="2362" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2364" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="2368" class="Symbol">))</a>
<a id="2371" href="TuringMachine2.html#2256" class="Function">δ₁</a> <a id="2374" class="Symbol">(</a><a id="2375" href="Data.Fin.Base.html#1148" class="InductiveConstructor">zero</a> <a id="2380" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2382" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="2387" class="Symbol">_)</a> <a id="2390" class="Symbol">=</a> <a id="2392" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>
<a id="2400" href="TuringMachine2.html#2256" class="Function">δ₁</a> <a id="2403" class="Symbol">((</a><a id="2405" href="Data.Fin.Base.html#1179" class="InductiveConstructor">suc</a> <a id="2409" href="Data.Fin.Base.html#1148" class="InductiveConstructor">zero</a><a id="2413" class="Symbol">)</a> <a id="2415" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2417" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a><a id="2424" class="Symbol">)</a> <a id="2426" class="Symbol">=</a> <a id="2428" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="2433" class="Symbol">(</a><a id="2434" href="Data.Fin.Base.html#1148" class="InductiveConstructor">zero</a> <a id="2439" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2441" class="Symbol">(</a><a id="2442" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="2447" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2449" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="2454" class="Symbol">))</a>
<a id="2457" href="TuringMachine2.html#2256" class="Function">δ₁</a> <a id="2460" class="Symbol">((</a><a id="2462" href="Data.Fin.Base.html#1179" class="InductiveConstructor">suc</a> <a id="2466" href="Data.Fin.Base.html#1148" class="InductiveConstructor">zero</a><a id="2470" class="Symbol">)</a> <a id="2472" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2474" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="2479" class="Symbol">_)</a> <a id="2482" class="Symbol">=</a> <a id="2484" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>

<a id="tm₁"></a><a id="2493" href="TuringMachine2.html#2493" class="Function">tm₁</a> <a id="2497" class="Symbol">:</a> <a id="2499" href="TuringMachine2.html#412" class="Record">TuringMachine₂</a> <a id="2514" class="Symbol">{</a><a id="2515" class="Number">1</a><a id="2516" class="Symbol">}</a>
<a id="2518" href="TuringMachine2.html#2493" class="Function">tm₁</a> <a id="2522" class="Symbol">=</a> <a id="2524" class="Keyword">record</a> <a id="2531" class="Symbol">{</a><a id="2532" href="TuringMachine2.html#461" class="Field">δ</a> <a id="2534" class="Symbol">=</a> <a id="2536" href="TuringMachine2.html#2256" class="Function">δ₁</a><a id="2538" class="Symbol">}</a>

<a id="run-nat"></a><a id="2541" href="TuringMachine2.html#2541" class="Function">run-nat</a> <a id="2549" class="Symbol">:</a> <a id="2551" class="Symbol">{</a><a id="2552" href="TuringMachine2.html#2552" class="Bound">n</a> <a id="2554" class="Symbol">:</a> <a id="2556" href="TuringMachine2.html#63" class="Datatype">Nat</a><a id="2559" class="Symbol">}</a> <a id="2561" class="Symbol">→</a> <a id="2563" href="TuringMachine2.html#412" class="Record">TuringMachine₂</a> <a id="2578" class="Symbol">{</a><a id="2579" href="TuringMachine2.html#2552" class="Bound">n</a><a id="2580" class="Symbol">}</a> <a id="2582" class="Symbol">→</a> <a id="2584" href="TuringMachine2.html#63" class="Datatype">Nat</a> <a id="2588" class="Symbol">→</a> <a id="2590" href="TuringMachine2.html#63" class="Datatype">Nat</a> <a id="2594" class="Symbol">→</a> <a id="2596" href="TuringMachine2.html#63" class="Datatype">Nat</a>
<a id="2600" href="TuringMachine2.html#2541" class="Function">run-nat</a> <a id="2608" class="Symbol">{</a><a id="2609" href="TuringMachine2.html#2609" class="Bound">n</a><a id="2610" class="Symbol">}</a> <a id="2612" href="TuringMachine2.html#2612" class="Bound">tm</a> <a id="2615" href="TuringMachine2.html#2615" class="Bound">tape</a> <a id="2620" href="TuringMachine2.html#2620" class="Bound">steps</a> <a id="2626" class="Symbol">=</a> <a id="2628" href="Base2.html#1200" class="Function">base2→unary</a> <a id="2640" class="Symbol">(</a><a id="2641" href="TuringMachine2.html#1948" class="Function">run-bool</a> <a id="2650" href="TuringMachine2.html#2612" class="Bound">tm</a> <a id="2653" class="Symbol">(</a><a id="2654" href="Base2.html#1094" class="Function">unary→base2</a> <a id="2666" href="TuringMachine2.html#2615" class="Bound">tape</a><a id="2670" class="Symbol">)</a> <a id="2672" href="TuringMachine2.html#2620" class="Bound">steps</a><a id="2677" class="Symbol">)</a>
</pre></body></html>